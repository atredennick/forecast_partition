source('~/Repos/forecast_partition/code/generate_forecast_fxns.R', echo=TRUE)
head(outcasts_combined)
forecast_var <- outcasts_combined %>%
group_by(year, simulation) %>%
summarise(variance = var(value))
head(forecast_var)
ggplot(forecast_var, aes(x = year, y = variance, color = simulation))+
geom_line()
forecast_var <- outcasts_combined %>%
group_by(year, simulation) %>%
summarise(variance = var(value)) %>%
spread(simulation, variance)
head(forecast_var)
##  Calculate variance
forecast_var <- outcasts_combined %>%
group_by(year, simulation) %>%
summarise(variance = var(value)) %>%
spread(simulation, variance) %>%
mutate(interaction = `B) No initial conditions error` + `C) No parameter error`) %>%
gather(simulation, variance, -year)
ggplot(forecast_var, aes(x = year, y = variance, color = simulation))+
geom_line()
outcasts_combined <- as.data.frame(outcasts_all) %>%
mutate(year = 0:n_times) %>%
gather(key,value,-year) %>%
mutate(simulation = "all") %>%
rbind(as.data.frame(outcasts_noinit) %>%
mutate(year = 0:n_times) %>%
gather(key,value,-year) %>%
mutate(simulation = "noinit")) %>%
rbind(as.data.frame(outcasts_noparam) %>%
mutate(year = 0:n_times) %>%
gather(key,value,-year) %>%
mutate(simulation = "noparam"))
##  Calculate variance
forecast_var <- outcasts_combined %>%
group_by(year, simulation) %>%
summarise(variance = var(value)) %>%
spread(simulation, variance) %>%
mutate(interaction = noinit + noparam) %>%
gather(simulation, variance, -year)
ggplot(forecast_var, aes(x = year, y = variance, color = simulation))+
geom_line()
interaction_var <- forecast_var %>%
spread(simulation, variance)
head(interaction_var)
interaction_var <- forecast_var %>%
spread(simulation, variance) %>%
mutate(interaction_effect = all - interaction)
interaction_var
ggplot(interaction_var, aes(x = year, y = interaction_effect))+
geom_line()
ggplot(forecast_var, aes(x = year, y = variance, color = simulation))+
geom_line()
ggplot(forecast_var, aes(x = year, y = variance, linetype = simulation))+
geom_line()
ggplot(forecast_var, aes(x = year, y = variance, color = simulation))+
geom_line()+
scale_color_brewer(palette = 1)
ggplot(forecast_var, aes(x = year, y = variance, color = simulation))+
geom_line()+
scale_color_brewer(palette = 2)
ggplot(forecast_var, aes(x = year, y = variance, color = simulation))+
geom_line()+
scale_color_brewer(palette = "Set1")
ggplot(forecast_var, aes(x = year, y = variance, color = simulation))+
geom_line()+
scale_color_brewer(palette = "Set1")+
theme_few()
ggplot(forecast_var, aes(x = year, y = variance, color = simulation))+
geom_line()+
scale_color_colorblind()+
theme_few()
ggplot(forecast_var, aes(x = year, y = variance, color = simulation))+
geom_line()+
xlab("Forecast year")+
ylab("Forecast variance")+
scale_color_colorblind()+
theme_few()
ggplot(forecast_var, aes(x = year, y = variance, color = simulation))+
geom_line()+
xlab("Forecast year")+
ylab("Forecast variance")+
scale_color_colorblind()+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()
ggplot(forecast_var, aes(x = year, y = variance, color = simulation))+
geom_line()+
xlab("Forecast year")+
ylab("Forecast variance")+
scale_color_colorblind()+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1))
ggplot(forecast_var, aes(x = year, y = variance, color = simulation))+
geom_line()+
xlab("Forecast year")+
ylab("Forecast variance")+
scale_color_colorblind()+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(0, 0))
ggplot(forecast_var, aes(x = year, y = variance, color = simulation))+
geom_line()+
xlab("Forecast year")+
ylab("Forecast variance")+
scale_color_colorblind()+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(1, 1))
ggplot(forecast_var, aes(x = year, y = variance, color = simulation))+
geom_line()+
xlab("Forecast year")+
ylab("Forecast variance")+
scale_color_colorblind()+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(4, 1))
ggplot(forecast_var, aes(x = year, y = variance, color = simulation))+
geom_line()+
xlab("Forecast year")+
ylab("Forecast variance")+
scale_color_colorblind()+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(0, 1))
ggplot(forecast_var, aes(x = year, y = variance, color = simulation))+
geom_line()+
xlab("Forecast year")+
ylab("Forecast variance")+
scale_color_colorblind()+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(-1, 1))
ggplot(forecast_var, aes(x = year, y = variance, color = simulation))+
geom_line()+
xlab("Forecast year")+
ylab("Forecast variance")+
scale_color_colorblind()+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(-0.5, 2))
ggplot(forecast_var, aes(x = year, y = variance, color = simulation))+
geom_line()+
xlab("Forecast year")+
ylab("Forecast variance")+
scale_color_colorblind()+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(-0.5, 1.2))
ggplot(forecast_var, aes(x = year, y = variance, color = simulation))+
geom_line()+
xlab("Forecast year")+
ylab("Forecast variance")+
scale_color_colorblind(name = NULL)+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(-0.5, 1.2))
ggplot(forecast_var, aes(x = year, y = variance, color = simulation))+
geom_line()+
xlab("Forecast year")+
ylab("Forecast variance")+
scale_color_colorblind(name = NULL)+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(-0.35, 1))
ggplot(forecast_var, aes(x = year, y = variance, color = simulation))+
geom_line()+
xlab("Forecast year")+
ylab("Forecast variance")+
scale_color_colorblind(name = NULL)+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(-0.45, 1))
ggplot(forecast_var, aes(x = year, y = variance, color = simulation))+
geom_line()+
xlab("Forecast year")+
ylab("Forecast variance")+
scale_color_colorblind(name = NULL)+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(-0.35, 1.1))
ggplot(forecast_var, aes(x = year, y = variance, color = simulation))+
geom_line()+
xlab("Forecast year")+
ylab("Forecast variance")+
scale_color_colorblind(name = NULL)+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(-0.3, 1.1))
ggplot(forecast_var, aes(x = year, y = variance, color = simulation))+
geom_line()+
xlab("Forecast year")+
ylab("Forecast variance")+
scale_color_colorblind(name = NULL)+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(-0.1, 1.1))
outcasts_combined <- as.data.frame(outcasts_all) %>%
mutate(year = 0:n_times) %>%
gather(key,value,-year) %>%
mutate(simulation = "all") %>%
rbind(as.data.frame(outcasts_noinit) %>%
mutate(year = 0:n_times) %>%
gather(key,value,-year) %>%
mutate(simulation = "noinit")) %>%
rbind(as.data.frame(outcasts_noparam) %>%
mutate(year = 0:n_times) %>%
gather(key,value,-year) %>%
mutate(simulation = "noparam"))
ggplot(outcasts_combined, aes(x = year, y = value, group = key))+
geom_line(color = "darkgrey", alpha = 0.8)+
facet_wrap(~simulation, ncol = 4)+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
ylab("State of interest")+
xlab("Forecast year")+
theme_few()+
theme(axis.text.y = element_blank())
##  Calculate variance
forecast_var <- outcasts_combined %>%
group_by(year, simulation) %>%
summarise(variance = var(value)) %>%
spread(simulation, variance) %>%
mutate(interaction = noinit + noparam) %>%
gather(simulation, variance, -year)
ggplot(forecast_var, aes(x = year, y = variance, color = simulation))+
geom_line()+
xlab("Forecast year")+
ylab("Forecast variance")
ggplot(forecast_var, aes(x = year, y = variance, color = simulation))+
geom_line()+
xlab("Forecast year")+
ylab("Forecast variance")+
scale_color_colorblind(name = NULL, labels = c("All sources","IC + Param. Error","Param Error","IC Error"))+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(-0.1, 1.1))
