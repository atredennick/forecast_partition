facet_wrap(~simulation, ncol = 4)+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
ylab("State of interest")+
xlab("Forecast year")+
theme_few()+
theme(axis.text.y = element_blank())
# ggsave(filename = "../figures/forecast_uncertainty_example.pdf", width = 8.5, height = 3, units = "in")
####
####  TEST CASE OF ANOVA WITH 2 SOURCES OF ERROR ONLY --------------------------
####
z_bar <- -20
z_sigma <- 1.5
a_bar <- 0.8
a_sigma <- 0.1
proc_sigma <- 0
n_times <- 10
n_iters <- 100
seed <- 126
outcasts_all <- generate_forecast(z_bar,
z_sigma,
a_bar,
a_sigma,
theta_bar = NULL,
theta_sigma = NULL,
x_bar = NULL,
x_sigma = NULL,
proc_sigma,
n_times,
n_iters,
seed)
outcasts_noinit <- generate_forecast(z_bar,
z_sigma = 0,
a_bar,
a_sigma,
theta_bar = NULL,
theta_sigma = NULL,
x_bar = NULL,
x_sigma = NULL,
proc_sigma,
n_times,
n_iters,
seed)
outcasts_noparam <- generate_forecast(z_bar,
z_sigma,
a_bar,
a_sigma = 0,
theta_bar = NULL,
theta_sigma = NULL,
x_bar = NULL,
x_sigma = NULL,
proc_sigma,
n_times,
n_iters,
seed)
outcasts_combined <- as.data.frame(outcasts_all) %>%
mutate(year = 0:n_times) %>%
gather(key,value,-year) %>%
mutate(simulation = "all") %>%
rbind(as.data.frame(outcasts_noinit) %>%
mutate(year = 0:n_times) %>%
gather(key,value,-year) %>%
mutate(simulation = "noinit")) %>%
rbind(as.data.frame(outcasts_noparam) %>%
mutate(year = 0:n_times) %>%
gather(key,value,-year) %>%
mutate(simulation = "noparam"))
ggplot(outcasts_combined, aes(x = year, y = value, group = key))+
geom_line(color = "darkgrey", alpha = 0.8)+
facet_wrap(~simulation, ncol = 4)+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
ylab("State of interest")+
xlab("Forecast year")+
theme_few()+
theme(axis.text.y = element_blank())
##  Calculate variance
forecast_var <- outcasts_combined %>%
group_by(year, simulation) %>%
summarise(variance = var(value)) %>%
spread(simulation, variance) %>%
mutate(interaction = noinit + noparam) %>%
gather(simulation, variance, -year)
mylabs <- c(expression(V^(F)),
expression(V^(I)+V^(PA)),
expression(V^(I)),
expression(V^(PA)))
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(color = simulation), size = 1.3)+
annotate("text", x = 8, y = 30, label = expression(epsilon^(IPA)))+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")+
scale_color_colorblind(name = NULL, labels = c("V(F)","IC + Param. Error","Param Error","IC Error"))+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(-0.1, 1.1))
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(color = simulation), size = 1.3)+
annotate("text", x = 8, y = 30, label = expression(epsilon^(IPA)))+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(color = simulation), size = 1.3)+
annotate("text", x = 8, y = 30, label = "test")+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(color = simulation), size = 1.3)+
annotate("text", x = 8, y = 30, label = "test")+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(color = simulation), size = 1.3)+
annotate("text", x = 8, y = 30, label = expression(eps))+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(color = simulation), size = 1.3)+
annotate("text", x = 8, y = 30, label = "Delta~italic('i')", parse = TRUE)+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(color = simulation), size = 1.3)+
annotate("text", x = 8, y = 30, label = "epsilon", parse = TRUE)+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(color = simulation), size = 1.3)+
annotate("text", x = 8, y = 30, label = "epsilon^(I)", parse = TRUE)+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(color = simulation), size = 1.3)+
annotate("text", x = 8, y = 30, label = "epsilon^(I,PA)", parse = TRUE)+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(color = simulation), size = 1.3)+
annotate("text", x = 8, y = 30, label = "epsilon^(I~,~PA)", parse = TRUE)+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(color = simulation), size = 1.3)+
annotate("text", x = 8, y = 30, label = "epsilon^(IPA)", parse = TRUE)+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(color = simulation), size = 1.3)+
annotate("text", x = 8, y = 30, label = "epsilon^(I','PA)", parse = TRUE)+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(color = simulation), size = 1.3)+
annotate("text", x = 8, y = 30, label = "epsilon^('IPA')", parse = TRUE)+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(color = simulation), size = 1.3)+
annotate("text", x = 8, y = 30, label = "epsilon^(italic('IPA'))", parse = TRUE)+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(color = simulation), size = 1.3)+
annotate("text", x = 8, y = 30, label = "epsilon^(italic('I,PA'))", parse = TRUE)+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(color = simulation), size = 1.3)+
annotate("text", x = 8, y = 30, label = "epsilon^(italic('I,PA'))", parse = TRUE)+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")+
scale_color_colorblind(name = NULL, labels = mylabs)
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(color = simulation), size = 1.3)+
annotate("text", x = 8, y = 30, label = "epsilon^(italic('I,PA'))", parse = TRUE)+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")+
scale_color_colorblind(name = NULL, labels = mylabs, parse =TRUE)+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(color = simulation), size = 1.3)+
annotate("text", x = 8, y = 30, label = "epsilon^(italic('I,PA'))", parse = TRUE)+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")+
scale_color_colorblind(name = NULL, labels = mylabs)+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(-0.1, 1.1))
ggsave(filename = "../figures/example_interaction_effect.pdf", width = 4.5, height = 4, units = "in")
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(color = simulation), size = 1.3)+
annotate("text", x = 8, y = 30, label = "epsilon^(italic('I,PA'))", parse = TRUE, size = 2)+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")+
scale_color_colorblind(name = NULL, labels = mylabs)+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(-0.1, 1.1))
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(color = simulation), size = 1.3)+
annotate("text", x = 8, y = 30, label = "epsilon^(italic('I,PA'))", parse = TRUE, size = 6)+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")+
scale_color_colorblind(name = NULL, labels = mylabs)+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(-0.1, 1.1))
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(color = simulation), size = 1.3)+
annotate("text", x = 8, y = 30, label = "epsilon^(italic('I,PA'))", parse = TRUE, size = 5)+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")+
scale_color_colorblind(name = NULL, labels = mylabs)+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(-0.1, 1.1))
ggsave(filename = "../figures/example_interaction_effect.pdf", width = 4.5, height = 4, units = "in")
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(color = simulation), size = 1.3)+
annotate("text", x = 8, y = 30, label = "epsilon^(italic('I,PA'))", parse = TRUE, size = 6)+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")+
scale_color_colorblind(name = NULL, labels = mylabs)+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(-0.1, 1.1),
legend.text=element_text(size=6))
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(color = simulation), size = 1.3)+
annotate("text", x = 8, y = 30, label = "epsilon^(italic('I,PA'))", parse = TRUE, size = 6)+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")+
scale_color_colorblind(name = NULL, labels = mylabs)+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(-0.1, 1.1),
legend.text=element_text(size=12))
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(color = simulation), size = 1.3)+
annotate("text", x = 8, y = 30, label = "epsilon^(italic('I,PA'))", parse = TRUE, size = 6)+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")+
scale_color_colorblind(name = NULL, labels = mylabs)+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(-0.1, 1.1),
legend.text=element_text(size=12),
legend.text.align = 0)
ggsave(filename = "../figures/example_interaction_effect.pdf", width = 4.5, height = 4, units = "in")
ggsave(filename = "../figures/example_interaction_effect.pdf", width = 3.5, height = 3, units = "in")
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(color = simulation), size = 1.3)+
annotate("text", x = 8, y = 30, label = "epsilon^(italic('I,PA'))", parse = TRUE, size = 5)+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")+
scale_color_colorblind(name = NULL, labels = mylabs)+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(-0.1, 1.1),
legend.text=element_text(size=10),
legend.text.align = 0)
ggsave(filename = "../figures/example_interaction_effect.pdf", width = 3.5, height = 3, units = "in")
source('~/Repos/forecast_partition/code/generate_forecast_fxns.R', echo=TRUE)
str(forecast_var)
str(outcasts_combined)
forecast_var <- outcasts_combined %>%
group_by(year, simulation) %>%
summarise(variance = var(value)) %>%
ungroup() %>%
spread(simulation, variance) %>%
mutate(interaction = noinit + noparam) %>%
gather(simulation, variance, -year)
str(forecast_var)
mylabs <- c(expression(V^(F)),
expression(V^(I)+V^(PA)),
expression(V^(PA)),
expression(V^(I)))
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(color = simulation), size = 1.3)+
annotate("text", x = 8, y = 30, label = "epsilon^(italic('I,PA'))", parse = TRUE, size = 5)+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")+
scale_color_colorblind(name = NULL, labels = mylabs)+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(-0.1, 1.1),
legend.text=element_text(size=10),
legend.text.align = 0)
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(linetype = simulation), size = 1.3)+
annotate("text", x = 8, y = 30, label = "epsilon^(italic('I,PA'))", parse = TRUE, size = 5)+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")+
# scale_color_colorblind(name = NULL, labels = mylabs)+
scale_linetype_discrete(labels = mylabs)+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(-0.1, 1.1),
legend.text=element_text(size=10),
legend.text.align = 0)
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(linetype = simulation), size = 1)+
annotate("text", x = 8, y = 30, label = "epsilon^(italic('I,PA'))", parse = TRUE, size = 5)+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")+
# scale_color_colorblind(name = NULL, labels = mylabs)+
scale_linetype_discrete(name = NULL, labels = mylabs)+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(-0.1, 1.1),
legend.text=element_text(size=10),
legend.text.align = 0)
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(linetype = simulation), size = 0.8)+
annotate("text", x = 8, y = 30, label = "epsilon^(italic('I,PA'))", parse = TRUE, size = 5)+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")+
# scale_color_colorblind(name = NULL, labels = mylabs)+
scale_linetype_discrete(name = NULL, labels = mylabs)+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(-0.1, 1.1),
legend.text=element_text(size=10),
legend.text.align = 0)
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(linetype = simulation), size = 0.8)+
annotate("text", x = 8, y = 30, label = "epsilon^(italic('I,PA'))", parse = TRUE, size = 5)+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")+
# scale_color_colorblind(name = NULL, labels = mylabs)+
scale_linetype_manual(values = c(1,2,3,6),name = NULL, labels = mylabs)+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(-0.1, 1.1),
legend.text=element_text(size=10),
legend.text.align = 0)
ggsave(filename = "../figures/example_interaction_effect.pdf", width = 3.5, height = 3, units = "in")
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(linetype = simulation), size = 0.8)+
annotate("text", x = 8, y = 30, label = "epsilon^(italic('I,PA'))", parse = TRUE, size = 5)+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")+
# scale_color_colorblind(name = NULL, labels = mylabs)+
scale_linetype_manual(values = c(1,2,3,6),name = NULL, labels = mylabs)+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(-0.1, 1.1),
legend.text=element_text(size=10),
legend.text.align = 0,
legend.key.width = unit(2,"cm"))
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(linetype = simulation), size = 0.8)+
annotate("text", x = 8, y = 30, label = "epsilon^(italic('I,PA'))", parse = TRUE, size = 5)+
xlab("Forecast year (T+q)")+
ylab("Forecast variance (V)")+
# scale_color_colorblind(name = NULL, labels = mylabs)+
scale_linetype_manual(values = c(1,2,3,6),name = NULL, labels = mylabs)+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(-0.1, 1.1),
legend.text=element_text(size=10),
legend.text.align = 0,
legend.key.width = unit(1,"cm"))
ggsave(filename = "../figures/example_interaction_effect.pdf", width = 3.5, height = 3, units = "in")
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(linetype = simulation), size = 0.8)+
annotate("text", x = 8, y = 30, label = "epsilon^(italic('I,PA'))", parse = TRUE, size = 5)+
xlab("Forecast year (T + q)")+
ylab("Forecast variance (V)")+
# scale_color_colorblind(name = NULL, labels = mylabs)+
scale_linetype_manual(values = c(1,2,3,6),name = NULL, labels = mylabs)+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(-0.1, 1.1),
legend.text=element_text(size=10),
legend.text.align = 0,
legend.key.width = unit(1,"cm"))
ggsave(filename = "../figures/example_interaction_effect.pdf", width = 3.5, height = 3, units = "in")
ggsave(filename = "../figures/example_interaction_effect.pdf", width = 4.2, height = 3, units = "in")
ggplot(forecast_var, aes(x = year, y = variance))+
geom_ribbon(aes(ymax = forecast_var[forecast_var$simulation=="all","variance"],
ymin = forecast_var[forecast_var$simulation=="interaction","variance"]),
fill = "grey88")+
geom_line(aes(linetype = simulation), size = 0.6)+
annotate("text", x = 8, y = 30, label = "epsilon^(italic('I,PA'))", parse = TRUE, size = 5)+
xlab("Forecast year (T + q)")+
ylab("Forecast variance (V)")+
# scale_color_colorblind(name = NULL, labels = mylabs)+
scale_linetype_manual(values = c(1,2,3,6),name = NULL, labels = mylabs)+
scale_x_continuous(breaks = c(0,2,4,6,8,10))+
theme_few()+
theme(legend.position = c(0,1),
legend.justification=c(-0.1, 1.1),
legend.text=element_text(size=10),
legend.text.align = 0,
legend.key.width = unit(1,"cm"))
ggsave(filename = "../figures/example_interaction_effect.pdf", width = 4.2, height = 3, units = "in")
